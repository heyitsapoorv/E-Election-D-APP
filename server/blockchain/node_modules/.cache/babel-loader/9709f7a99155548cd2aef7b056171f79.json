{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\DELL\\\\Downloads\\\\e-voting-Machine-using-blockchain-main\\\\blockchain\\\\src\\\\components\\\\custom\\\\Vote.js\";\nimport React, { Component } from 'react';\nimport Web3 from 'web3';\nimport Election from '../../build/Election.json';\nimport { Link } from 'react-router-dom';\nconst divStyle = {\n  backgroundColor: \"lightblue\",\n  marginTop: \"10px\",\n  borderRadius: \"10px\"\n};\n\nclass Vote extends Component {\n  async componentWillMount() {\n    await this.loadWeb3();\n    await this.loadBlockchainData();\n  }\n\n  async loadWeb3() {\n    if (window.ethereum) {\n      window.web3 = new Web3(window.ethereum);\n      await window.ethereum.enable();\n    } else if (window.web3) {\n      window.web3 = new Web3(window.web3.currentProvider);\n    } else {\n      window.alert('Non-Ethereum browser detected. You should consider trying MetaMask!');\n    }\n  }\n\n  async loadBlockchainData() {\n    const web3 = window.web3;\n    const accounts = await web3.eth.getAccounts();\n    console.log(accounts);\n    this.setState({\n      account: accounts[0]\n    });\n    const networkId = await web3.eth.net.getId();\n    const networkData = Election.networks[networkId];\n\n    if (networkData) {\n      const election = new web3.eth.Contract(Election.abi, networkData.address);\n      this.setState({\n        election\n      });\n      const candCount = await election.methods.candidatesCount().call();\n      this.setState({\n        candCount\n      });\n\n      for (var i = 1; i <= candCount; i++) {\n        const candidates = await election.methods.candidates(i).call();\n\n        if (candidates.election_id === this.state.id) {\n          this.setState({\n            candidates: [...this.state.candidates, candidates]\n          });\n        }\n      }\n\n      console.log(this.state.candidates);\n    } else {\n      window.alert('Election contract not deployed to detected network.');\n    }\n  }\n\n  vote(id) {\n    console.log(this.state.selectedId);\n    this.setState({\n      loading: true\n    });\n    this.state.election.methods.vote(id).send({\n      from: this.state.account\n    }).once('receipt', receipt => {\n      this.setState({\n        loading: false\n      });\n      window.location.assign(\"/\");\n    });\n  }\n\n  componentDidMount() {\n    let id = this.props.match.params.id;\n    this.setState({\n      id: id\n    });\n  }\n\n  constructor(props) {\n    super(props);\n\n    this.handleInputChange = e => {\n      console.log(e.target.id);\n      this.setState({\n        selectedId: e.target.id\n      });\n      this.vote(e.target.id);\n    };\n\n    this.state = {\n      id: null,\n      account: '',\n      election: null,\n      candCount: 0,\n      candidates: [],\n      loading: true,\n      selectedId: null\n    };\n  }\n\n  render() {\n    const electionList = this.state.candidates.map(candidates => {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"contact\",\n        key: candidates.id,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"li\", {\n        className: \"collection-item avatar\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 28\n        }\n      }, candidates.name)), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 28\n        }\n      }, candidates.details)), /*#__PURE__*/React.createElement(\"a\", {\n        href: \"\",\n        className: \"secondary-content\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        id: candidates.id,\n        onClick: this.handleInputChange,\n        class: \"btn btn-warning \",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 66\n        }\n      }, \"Vote\"))));\n    });\n    return /*#__PURE__*/React.createElement(\"div\", {\n      class: \"container-fluid\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"col-sm-6 login-section-wrapper\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"login-wrapper my-auto\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"ul\", {\n      className: \"collection\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"li\", {\n      className: \"collection-item avatar \",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"h3\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 25\n      }\n    }, \"Candidates\")), electionList)))), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"col-sm-6 px-0 d-none d-sm-block\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: \"login.jpg\",\n      alt: \"login image\",\n      class: \"login-img\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 17\n      }\n    }))));\n  }\n\n}\n\nexport default Vote;","map":{"version":3,"sources":["C:/Users/DELL/Downloads/e-voting-Machine-using-blockchain-main/blockchain/src/components/custom/Vote.js"],"names":["React","Component","Web3","Election","Link","divStyle","backgroundColor","marginTop","borderRadius","Vote","componentWillMount","loadWeb3","loadBlockchainData","window","ethereum","web3","enable","currentProvider","alert","accounts","eth","getAccounts","console","log","setState","account","networkId","net","getId","networkData","networks","election","Contract","abi","address","candCount","methods","candidatesCount","call","i","candidates","election_id","state","id","vote","selectedId","loading","send","from","once","receipt","location","assign","componentDidMount","props","match","params","constructor","handleInputChange","e","target","render","electionList","map","name","details"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,IAAP,MAAiB,MAAjB;AACA,OAAOC,QAAP,MAAqB,2BAArB;AACA,SAASC,IAAT,QAAqB,kBAArB;AAEA,MAAMC,QAAQ,GAAG;AACbC,EAAAA,eAAe,EAAC,WADH;AAEbC,EAAAA,SAAS,EAAE,MAFE;AAGbC,EAAAA,YAAY,EAAC;AAHA,CAAjB;;AAMA,MAAMC,IAAN,SAAmBR,SAAnB,CAA6B;AAED,QAAlBS,kBAAkB,GAAG;AACvB,UAAM,KAAKC,QAAL,EAAN;AACA,UAAM,KAAKC,kBAAL,EAAN;AACD;;AAEW,QAARD,QAAQ,GAAG;AACb,QAAIE,MAAM,CAACC,QAAX,EAAqB;AACjBD,MAAAA,MAAM,CAACE,IAAP,GAAc,IAAIb,IAAJ,CAASW,MAAM,CAACC,QAAhB,CAAd;AACA,YAAMD,MAAM,CAACC,QAAP,CAAgBE,MAAhB,EAAN;AACH,KAHD,MAIK,IAAIH,MAAM,CAACE,IAAX,EAAiB;AAClBF,MAAAA,MAAM,CAACE,IAAP,GAAc,IAAIb,IAAJ,CAASW,MAAM,CAACE,IAAP,CAAYE,eAArB,CAAd;AACH,KAFI,MAGA;AACDJ,MAAAA,MAAM,CAACK,KAAP,CAAa,qEAAb;AACH;AACJ;;AAEuB,QAAlBN,kBAAkB,GAAG;AACvB,UAAMG,IAAI,GAAGF,MAAM,CAACE,IAApB;AACA,UAAMI,QAAQ,GAAG,MAAMJ,IAAI,CAACK,GAAL,CAASC,WAAT,EAAvB;AACAC,IAAAA,OAAO,CAACC,GAAR,CAAYJ,QAAZ;AACA,SAAKK,QAAL,CAAc;AAAEC,MAAAA,OAAO,EAAEN,QAAQ,CAAC,CAAD;AAAnB,KAAd;AACA,UAAMO,SAAS,GAAG,MAAMX,IAAI,CAACK,GAAL,CAASO,GAAT,CAAaC,KAAb,EAAxB;AACA,UAAMC,WAAW,GAAG1B,QAAQ,CAAC2B,QAAT,CAAkBJ,SAAlB,CAApB;;AACA,QAAGG,WAAH,EAAgB;AACZ,YAAME,QAAQ,GAAG,IAAIhB,IAAI,CAACK,GAAL,CAASY,QAAb,CAAsB7B,QAAQ,CAAC8B,GAA/B,EAAoCJ,WAAW,CAACK,OAAhD,CAAjB;AACA,WAAKV,QAAL,CAAc;AAAEO,QAAAA;AAAF,OAAd;AACA,YAAMI,SAAS,GAAG,MAAMJ,QAAQ,CAACK,OAAT,CAAiBC,eAAjB,GAAmCC,IAAnC,EAAxB;AACA,WAAKd,QAAL,CAAc;AAAEW,QAAAA;AAAF,OAAd;;AACA,WAAK,IAAII,CAAC,GAAG,CAAb,EAAgBA,CAAC,IAAIJ,SAArB,EAAgCI,CAAC,EAAjC,EAAqC;AACjC,cAAMC,UAAU,GAAG,MAAMT,QAAQ,CAACK,OAAT,CAAiBI,UAAjB,CAA4BD,CAA5B,EAA+BD,IAA/B,EAAzB;;AACA,YAAGE,UAAU,CAACC,WAAX,KAA2B,KAAKC,KAAL,CAAWC,EAAzC,EAA4C;AACxC,eAAKnB,QAAL,CAAc;AACVgB,YAAAA,UAAU,EAAE,CAAC,GAAG,KAAKE,KAAL,CAAWF,UAAf,EAA2BA,UAA3B;AADF,WAAd;AAGH;AACJ;;AACDlB,MAAAA,OAAO,CAACC,GAAR,CAAY,KAAKmB,KAAL,CAAWF,UAAvB;AACH,KAdD,MAcO;AACH3B,MAAAA,MAAM,CAACK,KAAP,CAAa,qDAAb;AACH;AACJ;;AAWD0B,EAAAA,IAAI,CAACD,EAAD,EAAK;AACLrB,IAAAA,OAAO,CAACC,GAAR,CAAY,KAAKmB,KAAL,CAAWG,UAAvB;AACA,SAAKrB,QAAL,CAAc;AAAEsB,MAAAA,OAAO,EAAE;AAAX,KAAd;AACA,SAAKJ,KAAL,CAAWX,QAAX,CAAoBK,OAApB,CAA4BQ,IAA5B,CAAiCD,EAAjC,EAAqCI,IAArC,CAA0C;AAAEC,MAAAA,IAAI,EAAE,KAAKN,KAAL,CAAWjB;AAAnB,KAA1C,EACCwB,IADD,CACM,SADN,EACkBC,OAAD,IAAa;AAC1B,WAAK1B,QAAL,CAAc;AAAEsB,QAAAA,OAAO,EAAE;AAAX,OAAd;AACAjC,MAAAA,MAAM,CAACsC,QAAP,CAAgBC,MAAhB,CAAuB,GAAvB;AACH,KAJD;AAKH;;AAEDC,EAAAA,iBAAiB,GAAE;AACf,QAAIV,EAAE,GAAG,KAAKW,KAAL,CAAWC,KAAX,CAAiBC,MAAjB,CAAwBb,EAAjC;AACA,SAAKnB,QAAL,CAAc;AACVmB,MAAAA,EAAE,EAAEA;AADM,KAAd;AAGH;;AAEDc,EAAAA,WAAW,CAACH,KAAD,EAAQ;AACf,UAAMA,KAAN;;AADe,SA1BnBI,iBA0BmB,GA1BEC,CAAD,IAAO;AACvBrC,MAAAA,OAAO,CAACC,GAAR,CAAYoC,CAAC,CAACC,MAAF,CAASjB,EAArB;AACA,WAAKnB,QAAL,CAAc;AACVqB,QAAAA,UAAU,EAAEc,CAAC,CAACC,MAAF,CAASjB;AADX,OAAd;AAGA,WAAKC,IAAL,CAAUe,CAAC,CAACC,MAAF,CAASjB,EAAnB;AACH,KAoBkB;;AAEf,SAAKD,KAAL,GAAa;AACTC,MAAAA,EAAE,EAAE,IADK;AAETlB,MAAAA,OAAO,EAAE,EAFA;AAGTM,MAAAA,QAAQ,EAAE,IAHD;AAITI,MAAAA,SAAS,EAAE,CAJF;AAKTK,MAAAA,UAAU,EAAE,EALH;AAMTM,MAAAA,OAAO,EAAE,IANA;AAOTD,MAAAA,UAAU,EAAE;AAPH,KAAb;AASH;;AAEDgB,EAAAA,MAAM,GAAE;AACJ,UAAMC,YAAY,GAAG,KAAKpB,KAAL,CAAWF,UAAX,CAAsBuB,GAAtB,CAA0BvB,UAAU,IAAI;AACzD,0BACI;AAAK,QAAA,SAAS,EAAC,SAAf;AAAyB,QAAA,GAAG,EAAEA,UAAU,CAACG,EAAzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACI;AAAI,QAAA,SAAS,EAAC,wBAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAEI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAIH,UAAU,CAACwB,IAAf,CAAH,CAFJ,eAGI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAIxB,UAAU,CAACyB,OAAf,CAAH,CAHJ,eAII;AAAG,QAAA,IAAI,EAAC,EAAR;AAAW,QAAA,SAAS,EAAC,mBAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAAyC;AAAQ,QAAA,EAAE,EAAEzB,UAAU,CAACG,EAAvB;AAA2B,QAAA,OAAO,EAAE,KAAKe,iBAAzC;AAA6D,QAAA,KAAK,EAAC,kBAAnE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAzC,CAJJ,CADJ,CADJ;AAUH,KAXoB,CAArB;AAYA,wBACI;AAAK,MAAA,KAAK,EAAC,iBAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACA;AAAK,MAAA,KAAK,EAAC,KAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAK,MAAA,KAAK,EAAC,gCAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAEE;AAAK,MAAA,KAAK,EAAC,uBAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAEJ;AAAK,MAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAI,MAAA,SAAS,EAAC,YAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAI,MAAA,SAAS,EAAC,yBAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADJ,CADJ,EAISI,YAJT,CADJ,CAFI,CAFF,CADF,eAeE;AAAK,MAAA,KAAK,EAAC,iCAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAK,MAAA,GAAG,EAAC,WAAT;AAAqB,MAAA,GAAG,EAAC,aAAzB;AAAuC,MAAA,KAAK,EAAC,WAA7C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CAfF,CADA,CADJ;AAuBH;;AAzHwB;;AA4H7B,eAAerD,IAAf","sourcesContent":["import React, { Component } from 'react';\nimport Web3 from 'web3';\nimport Election from '../../build/Election.json'\nimport { Link } from 'react-router-dom'\n\nconst divStyle = {\n    backgroundColor:\"lightblue\" ,\n    marginTop :\"10px\", \n    borderRadius:\"10px\"\n}\n\nclass Vote extends Component {\n\n    async componentWillMount() {\n        await this.loadWeb3()\n        await this.loadBlockchainData()\n      }\n    \n    async loadWeb3() {\n        if (window.ethereum) {\n            window.web3 = new Web3(window.ethereum)\n            await window.ethereum.enable()\n        }\n        else if (window.web3) {\n            window.web3 = new Web3(window.web3.currentProvider)\n        }\n        else {\n            window.alert('Non-Ethereum browser detected. You should consider trying MetaMask!')\n        }\n    }\n\n    async loadBlockchainData() {\n        const web3 = window.web3\n        const accounts = await web3.eth.getAccounts()\n        console.log(accounts)\n        this.setState({ account: accounts[0] })\n        const networkId = await web3.eth.net.getId()\n        const networkData = Election.networks[networkId]\n        if(networkData) {\n            const election = new web3.eth.Contract(Election.abi, networkData.address)\n            this.setState({ election })\n            const candCount = await election.methods.candidatesCount().call()\n            this.setState({ candCount })\n            for (var i = 1; i <= candCount; i++) {\n                const candidates = await election.methods.candidates(i).call()\n                if(candidates.election_id === this.state.id){\n                    this.setState({\n                        candidates: [...this.state.candidates, candidates]\n                    })\n                }\n            }\n            console.log(this.state.candidates)\n        } else {\n            window.alert('Election contract not deployed to detected network.')\n        }\n    }\n\n    handleInputChange = (e) => {\n        console.log(e.target.id)\n        this.setState({\n            selectedId: e.target.id,\n        })\n        this.vote(e.target.id);\n    }\n\n\n    vote(id) {\n        console.log(this.state.selectedId)\n        this.setState({ loading: true })\n        this.state.election.methods.vote(id).send({ from: this.state.account })\n        .once('receipt', (receipt) => {\n            this.setState({ loading: false })\n            window.location.assign(\"/\");\n        })\n    }\n\n    componentDidMount(){\n        let id = this.props.match.params.id;\n        this.setState({\n            id: id,\n        })\n    }\n\n    constructor(props) {\n        super(props)\n        this.state = {\n            id: null,\n            account: '',\n            election: null,\n            candCount: 0,\n            candidates: [],\n            loading: true,\n            selectedId: null\n        }\n    }\n\n    render(){\n        const electionList = this.state.candidates.map(candidates => {\n            return (\n                <div className=\"contact\" key={candidates.id} >\n                    <li className=\"collection-item avatar\" >\n                        {/* <i className=\"material-icons circle blue darken-2\">ballot</i> */}\n                        <p><b>{candidates.name}</b></p>\n                        <p><b>{candidates.details}</b></p>\n                        <a href=\"\" className=\"secondary-content\"><button id={candidates.id} onClick={this.handleInputChange}  class=\"btn btn-warning \">Vote</button></a>\n                    </li>\n                </div>\n            )\n        }) \n        return(\n            <div class=\"container-fluid\">\n            <div class=\"row\">\n              <div class=\"col-sm-6 login-section-wrapper\">\n\n                <div class=\"login-wrapper my-auto\">\n                  {/* <h1 class=\"login-title\">Create New Election</h1> */}\n            <div className=\"container\" > \n                <ul className=\"collection\">\n                    <li className=\"collection-item avatar \">\n                        <h3>Candidates</h3>\n                    </li>\n                        {electionList}\n                </ul>\n            </div>\n            </div>\n              </div>\n              <div class=\"col-sm-6 px-0 d-none d-sm-block\">\n                <img src=\"login.jpg\" alt=\"login image\" class=\"login-img\"/>\n              </div>\n            </div>\n          </div>\n        )\n    }\n}\n\nexport default Vote;"]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import _toConsumableArray from\"C:/Users/DELL/Desktop/e-voting-Machine-using-blockchain-main/server/blockchain/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"C:/Users/DELL/Desktop/e-voting-Machine-using-blockchain-main/server/blockchain/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/DELL/Desktop/e-voting-Machine-using-blockchain-main/server/blockchain/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:/Users/DELL/Desktop/e-voting-Machine-using-blockchain-main/server/blockchain/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/DELL/Desktop/e-voting-Machine-using-blockchain-main/server/blockchain/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/Users/DELL/Desktop/e-voting-Machine-using-blockchain-main/server/blockchain/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/DELL/Desktop/e-voting-Machine-using-blockchain-main/server/blockchain/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import Web3 from'web3';import Election from'../../build/Election.json';import{Link}from'react-router-dom';var divStyle={backgroundColor:\"lightblue\",marginTop:\"10px\",borderRadius:\"10px\"};var VoteCount=/*#__PURE__*/function(_Component){_inherits(VoteCount,_Component);var _super=_createSuper(VoteCount);function VoteCount(props){var _this;_classCallCheck(this,VoteCount);_this=_super.call(this,props);_this.handleInputChange=function(e){console.log(e.target.id);_this.setState({selectedId:e.target.id});_this.vote(e.target.id);};_this.state={id:null,account:'',election:null,candCount:0,candidates:[],loading:true,selectedId:null};return _this;}_createClass(VoteCount,[{key:\"componentWillMount\",value:function(){var _componentWillMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return this.loadWeb3();case 2:_context.next=4;return this.loadBlockchainData();case 4:case\"end\":return _context.stop();}}},_callee,this);}));function componentWillMount(){return _componentWillMount.apply(this,arguments);}return componentWillMount;}()},{key:\"loadWeb3\",value:function(){var _loadWeb=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!window.ethereum){_context2.next=6;break;}window.web3=new Web3(window.ethereum);_context2.next=4;return window.ethereum.enable();case 4:_context2.next=7;break;case 6:if(window.web3){window.web3=new Web3(window.web3.currentProvider);}else{window.alert('Non-Ethereum browser detected. You should consider trying MetaMask!');}case 7:case\"end\":return _context2.stop();}}},_callee2);}));function loadWeb3(){return _loadWeb.apply(this,arguments);}return loadWeb3;}()},{key:\"loadBlockchainData\",value:function(){var _loadBlockchainData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var web3,accounts,networkId,networkData,election,candCount,i,candidates;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:web3=window.web3;_context3.next=3;return web3.eth.getAccounts();case 3:accounts=_context3.sent;console.log(accounts);this.setState({account:accounts[0]});_context3.next=8;return web3.eth.net.getId();case 8:networkId=_context3.sent;networkData=Election.networks[networkId];if(!networkData){_context3.next=29;break;}election=new web3.eth.Contract(Election.abi,networkData.address);this.setState({election:election});_context3.next=15;return election.methods.candidatesCount().call();case 15:candCount=_context3.sent;this.setState({candCount:candCount});i=1;case 18:if(!(i<=candCount)){_context3.next=26;break;}_context3.next=21;return election.methods.candidates(i).call();case 21:candidates=_context3.sent;if(candidates.election_id===this.state.id){this.setState({candidates:[].concat(_toConsumableArray(this.state.candidates),[candidates])});}case 23:i++;_context3.next=18;break;case 26:console.log(this.state.candidates);_context3.next=30;break;case 29:window.alert('Election contract not deployed to detected network.');case 30:case\"end\":return _context3.stop();}}},_callee3,this);}));function loadBlockchainData(){return _loadBlockchainData.apply(this,arguments);}return loadBlockchainData;}()},{key:\"vote\",value:function vote(id){var _this2=this;console.log(this.state.selectedId);this.setState({loading:true});this.state.election.methods.vote(id).send({from:this.state.account}).once('receipt',function(receipt){_this2.setState({loading:false});window.location.assign(\"/\");});}},{key:\"componentDidMount\",value:function componentDidMount(){var id=this.props.match.params.id;this.setState({id:id});}},{key:\"render\",value:function render(){var electionList=this.state.candidates.map(function(candidates){return/*#__PURE__*/React.createElement(\"div\",{className:\"contact\",key:candidates.id},/*#__PURE__*/React.createElement(\"li\",{className:\"collection-item avatar\"},/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"b\",null,\"Candidate Name : \",candidates.name)),/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"b\",null,\"Party Name : \",candidates.details)),/*#__PURE__*/React.createElement(\"p\",{className:\"secondary-content\"},/*#__PURE__*/React.createElement(\"b\",null,\"Votes : \",candidates.voteCount))));});return/*#__PURE__*/React.createElement(\"div\",{class:\"container-fluid\"},/*#__PURE__*/React.createElement(\"div\",{class:\"row\"},/*#__PURE__*/React.createElement(\"div\",{class:\"col-sm-6 login-section-wrapper\"},/*#__PURE__*/React.createElement(\"div\",{class:\"login-wrapper my-auto\"},/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},/*#__PURE__*/React.createElement(\"ul\",{className:\"collection\"},/*#__PURE__*/React.createElement(\"li\",{className:\"collection-item avatar\"},/*#__PURE__*/React.createElement(\"p\",{className:\"title\"},\"Candidates\")),electionList))))));}}]);return VoteCount;}(Component);export default VoteCount;","map":{"version":3,"sources":["C:/Users/DELL/Desktop/e-voting-Machine-using-blockchain-main/server/blockchain/src/components/custom/VoteCount.js"],"names":["React","Component","Web3","Election","Link","divStyle","backgroundColor","marginTop","borderRadius","VoteCount","props","handleInputChange","e","console","log","target","id","setState","selectedId","vote","state","account","election","candCount","candidates","loading","loadWeb3","loadBlockchainData","window","ethereum","web3","enable","currentProvider","alert","eth","getAccounts","accounts","net","getId","networkId","networkData","networks","Contract","abi","address","methods","candidatesCount","call","i","election_id","send","from","once","receipt","location","assign","match","params","electionList","map","name","details","voteCount"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport Web3 from 'web3';\nimport Election from '../../build/Election.json'\nimport { Link } from 'react-router-dom'\n\n\nconst divStyle = {\n    backgroundColor:\"lightblue\" ,\n    marginTop :\"10px\", \n    borderRadius:\"10px\"\n}\n\nclass VoteCount extends Component {\n\n    async componentWillMount() {\n        await this.loadWeb3()\n        await this.loadBlockchainData()\n      }\n    \n    async loadWeb3() {\n        if (window.ethereum) {\n            window.web3 = new Web3(window.ethereum)\n            await window.ethereum.enable()\n        }\n        else if (window.web3) {\n            window.web3 = new Web3(window.web3.currentProvider)\n        }\n        else {\n            window.alert('Non-Ethereum browser detected. You should consider trying MetaMask!')\n        }\n    }\n\n    async loadBlockchainData() {\n        const web3 = window.web3\n        const accounts = await web3.eth.getAccounts()\n        console.log(accounts)\n        this.setState({ account: accounts[0] })\n        const networkId = await web3.eth.net.getId()\n        const networkData = Election.networks[networkId]\n        if(networkData) {\n            const election = new web3.eth.Contract(Election.abi, networkData.address)\n            this.setState({ election })\n            const candCount = await election.methods.candidatesCount().call()\n            this.setState({ candCount })\n            for (var i = 1; i <= candCount; i++) {\n                const candidates = await election.methods.candidates(i).call()\n                if(candidates.election_id === this.state.id){\n                    this.setState({\n                        candidates: [...this.state.candidates, candidates]\n                    })\n                }\n            }\n            console.log(this.state.candidates)\n        } else {\n            window.alert('Election contract not deployed to detected network.')\n        }\n    }\n\n    handleInputChange = (e) => {\n        console.log(e.target.id)\n        this.setState({\n            selectedId: e.target.id,\n        })\n        this.vote(e.target.id);\n    }\n\n\n    vote(id) {\n        console.log(this.state.selectedId)\n        this.setState({ loading: true })\n        this.state.election.methods.vote(id).send({ from: this.state.account })\n        .once('receipt', (receipt) => {\n            this.setState({ loading: false })\n            window.location.assign(\"/\");\n        })\n    }\n\n    componentDidMount(){\n        let id = this.props.match.params.id;\n        this.setState({\n            id: id,\n        })\n    }\n\n    constructor(props) {\n        super(props)\n        this.state = {\n            id: null,\n            account: '',\n            election: null,\n            candCount: 0,\n            candidates: [],\n            loading: true,\n            selectedId: null\n        }\n    }\n\n    render(){\n        const electionList = this.state.candidates.map(candidates => {\n            return (\n                <div className=\"contact\" key={candidates.id}>\n                    <li className=\"collection-item avatar\" >\n                        {/* <i className=\"material-icons circle blue darken-2\">ballot</i> */}\n                        <p><b>Candidate Name : {candidates.name}</b></p>\n                        <p><b>Party Name : {candidates.details}</b></p>\n                        <p className=\"secondary-content\"><b>Votes : {candidates.voteCount}</b></p>\n                    </li>\n                </div>\n            )\n        }) \n        return(\n            <div class=\"container-fluid\">\n            <div class=\"row\">\n              <div class=\"col-sm-6 login-section-wrapper\">\n\n                <div class=\"login-wrapper my-auto\">\n                  {/* <h1 class=\"login-title\">Create New Election</h1> */}\n            <div className=\"container\">\n                <ul className=\"collection\">\n                    <li className=\"collection-item avatar\" >\n                        <p className=\"title\">Candidates</p>\n                    </li>\n                        {electionList}\n                </ul>\n            </div>\n            </div>\n            </div>\n\n          </div>\n        </div>\n        )\n    }\n}\n\nexport default VoteCount;"]},"metadata":{},"sourceType":"module"}